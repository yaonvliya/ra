"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _proj=require("ol/proj"),_proj2=_interopRequireDefault(_proj),_stroke=require("ol/style/stroke"),_stroke2=_interopRequireDefault(_stroke),_style=require("ol/style/style"),_style2=_interopRequireDefault(_style),_circle=require("ol/style/circle"),_circle2=_interopRequireDefault(_circle),_fill=require("ol/style/fill"),_fill2=_interopRequireDefault(_fill),_icon=require("ol/style/icon"),_icon2=_interopRequireDefault(_icon),_draw=require("ol/interaction/draw"),_draw2=_interopRequireDefault(_draw),_snap=require("ol/interaction/snap"),_snap2=_interopRequireDefault(_snap),_vector=require("ol/source/vector"),_vector2=_interopRequireDefault(_vector),_vector3=require("ol/layer/vector"),_vector4=_interopRequireDefault(_vector3),_geojson=require("ol/format/geojson"),_geojson2=_interopRequireDefault(_geojson),DrawTool=function(e){this._init(e)};DrawTool.prototype={_init:function(e){this.map=e.map,this.draw=null,this.snap=null,this.isSnap=!1,this._source=new _vector2.default,this._vectorLayer=new _vector4.default({source:this._source,name:"draw_temply",zIndex:9999}),null==e.style&&void 0==e.style||this._vectorLayer.setStyle(e.style),this.map.addLayer(this._vectorLayer)},startDraw:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments[2];this.draw&&(this.map.removeInteraction(this.draw),this.draw=null),this.draw=this._newInteraction(e),this.snap=new _snap2.default({source:this._source}),this.map.addInteraction(this.draw),this.map.addInteraction(this.snap),this.isSnap=t,this.snap.setActive(this.isSnap),this.draw.on("drawend",function(e){r&&r({feature:(new _geojson2.default).writeFeatureObject(e.feature)})})},_newInteraction:function(e){var t=null,r=null;return"Square"===e?(t=_draw2.default.createRegularPolygon(4),r=new _draw2.default({source:this._source,type:"Circle",geometryFunction:t,style:this.drawStyleFunction})):"Box"===e?(t=_draw2.default.createBox(),r=new _draw2.default({source:this._source,type:"Circle",geometryFunction:t,style:this.drawStyleFunction})):r=new _draw2.default({source:this._source,type:e,style:this.drawStyleFunction}),r},startSnap:function(){this.isSnap=!0,this.snap.setActive(!0)},stopSnap:function(){this.isSnap=!1,this.snap.setActive(!1)},clearDraw:function(){this._source.clear()},reStartDraw:function(){this.draw.setActive(!0)},stopDraw:function(){this.draw.setActive(!1)},eventDataTools:function(e){var t=e.feature;if("Circle"===e.feature.getGeometry().getType()){var r={};return r.type="Circle",r.center=e.feature.getGeometry().getCenter(),r.radius=e.feature.getGeometry().getRadius(),r}return(new _geojson2.default).writeFeature(t,{dataProjection:_proj2.default.get("EPSG:4326"),featureProjection:_proj2.default.get("EPSG:3857")})},drawStyleFunction:function(){return new _style2.default({image:new _circle2.default({radius:8,stroke:new _stroke2.default({color:"#000000",width:1}),fill:new _fill2.default({color:"#ffcc33"})}),fill:new _fill2.default({color:"rgba(255, 255, 255, 0.2)"}),stroke:new _stroke2.default({color:"#ffcc33",width:2})})}},exports.default=DrawTool;